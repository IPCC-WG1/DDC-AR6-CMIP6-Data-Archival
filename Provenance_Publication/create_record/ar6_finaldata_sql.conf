# CERA2 Select statements for creation of information for zenodo records documenting CMIP6 data usage in AR6 WGI figures
#
# Creation: 2024-03-08 by M. Stockhause
#
#FIG_LIST:select distinct cds.citation_id,cds.additional_info as FIGURE from cera2.campaign c,cera2.entry edoi,cera2.entry eds,cera2.entry_connect ec1,cera2.entry_connect ec2,cera2.reference rdoi,cera2.citation cdoi,cera2.reference rds,cera2.citation cds,cera2.entry_pid ep where c.project_id=2000125 and c.entry_id=ec1.gen_entry_id and ec1.spec_entry_id=ec2.gen_entry_id and ec2.gen_entry_id=edoi.entry_id and ec2.spec_entry_id=eds.entry_id and edoi.entry_id=rdoi.entry_id and rdoi.citation_id=cdoi.citation_id and rdoi.ref_type_id=2000004 and eds.entry_id=rds.entry_id and eds.entry_id=ep.entry_id and rds.citation_id=cds.citation_id and (cds.publisher='NERC EDS Centre for Environmental Data Analysis' or cds.additional_info like 'Atlas%') and cds.publisher!='IPCC' order by figure
FIG_LIST:select distinct cds.citation_id,cds.additional_info as FIGURE,replace(car6.access_spec,'doi:','') as CHAPTER from cera2.campaign c,cera2.entry edoi,cera2.entry eds,cera2.entry_connect ec1,cera2.entry_connect ec2,cera2.reference rdoi,cera2.citation cdoi,cera2.reference rds,cera2.citation cds,cera2.entry_pid ep,cera2.reference rar6,cera2.citation car6 where c.project_id=2000125 and c.entry_id=ec1.gen_entry_id and ec1.spec_entry_id=ec2.gen_entry_id and ec2.gen_entry_id=edoi.entry_id and ec2.spec_entry_id=eds.entry_id and edoi.entry_id=rdoi.entry_id and rdoi.citation_id=cdoi.citation_id and rdoi.ref_type_id=2000004 and eds.entry_id=rds.entry_id and eds.entry_id=ep.entry_id and rds.citation_id=cds.citation_id and (cds.publisher='NERC EDS Centre for Environmental Data Analysis' or cds.additional_info like 'Atlas%') and cds.publisher!='IPCC' and edoi.entry_id=rar6.entry_id and rar6.citation_id=car6.citation_id and (car6.additional_info like 'Chapter%'||SUBSTR(cds.additional_info, 0, INSTR(cds.additional_info, '.')-1)||';%' or (car6.additional_info like 'Chapter%'||SUBSTR(SUBSTR(cds.additional_info, 0, INSTR(cds.additional_info, '.')-1),4,2)||';%' and SUBSTR(SUBSTR(cds.additional_info, 0, INSTR(cds.additional_info, '.')-1),4,2) is not NULL) or car6.additional_info like SUBSTR(cds.additional_info, 0, INSTR(cds.additional_info, '.')-1)||'%')  order by figure
#FIG_INFO:select replace(eds.entry_name,' ','.') as dataset,replace(ep.pid,'hdl:','https://hdl.handle.net/') as DS_PID,replace(edoi.entry_name,' ','.') as doi_collection,replace(cdoi.access_spec,'doi:','') as AR6_CMIP6_DOI,replace(ccmip.access_spec,'doi:','') as CMIP6_DOI,cipcc.access_spec as FIG_URL,cds.additional_info as FIGURE,replace(cds.access_spec,'doi:','') as FIGURE_DOI,replace(csw.access_spec,'doi:','') as CODE_DOI from cera2.campaign c,cera2.entry edoi,cera2.entry eds,cera2.entry_connect ec1,cera2.entry_connect ec2,cera2.reference rdoi,cera2.citation cdoi,cera2.reference rds,cera2.citation cds,cera2.entry_pid ep,cera2.reference rcmip,cera2.citation ccmip,cera2.reference ripcc,cera2.citation cipcc,cera2.reference rsw, cera2.citation csw where c.project_id=2000125 and c.entry_id=ec1.gen_entry_id and ec1.spec_entry_id=ec2.gen_entry_id and ec2.gen_entry_id=edoi.entry_id and ec2.spec_entry_id=eds.entry_id and edoi.entry_id=rdoi.entry_id(+) and rdoi.citation_id=cdoi.citation_id(+) and rdoi.ref_type_id(+)=2000004 and eds.entry_id=rds.entry_id and rcmip.entry_id=edoi.entry_id and rcmip.citation_id=ccmip.citation_id and rcmip.ref_type_id=27 and ccmip.publisher='Earth System Grid Federation' and ripcc.entry_id=eds.entry_id and ripcc.citation_id=cipcc.citation_id and cipcc.publisher='IPCC' and cipcc.additional_info=cds.additional_info and eds.entry_id=ep.entry_id and rds.citation_id=cds.citation_id and cipcc.access_spec like '%ipcc.ch%' and rsw.entry_id=eds.entry_id and rsw.entry_id=eds.entry_id and rsw.citation_id=csw.citation_id and csw.additional_info=cds.additional_info and csw.access_spec like 'doi:10.5281/zenodo.%' and csw.additional_info not like 'Atlas%' and cds.citation_id=${citation_id} order by eds.entry_name
FIG_INFO:select replace(eds.entry_name,' ','.') as dataset,replace(ep.pid,'hdl:','https://hdl.handle.net/') as DS_PID,replace(edoi.entry_name,' ','.') as doi_collection,replace(cdoi.access_spec,'doi:','') as AR6_CMIP6_DOI,replace(ccmip.access_spec,'doi:','') as CMIP6_DOI,cipcc.access_spec as FIG_URL,cds.additional_info as FIGURE,replace(cds.access_spec,'doi:','') as FIGURE_DOI,replace(csw.access_spec,'doi:','') as CODE_DOI,cgit.access_spec as CODE_GIT from cera2.campaign c,cera2.entry edoi,cera2.entry eds,cera2.entry_connect ec1,cera2.entry_connect ec2,cera2.reference rdoi,cera2.citation cdoi,cera2.reference rds,cera2.citation cds,cera2.entry_pid ep,cera2.reference rcmip,cera2.citation ccmip,cera2.reference ripcc,cera2.citation cipcc,cera2.reference rsw, cera2.citation csw, cera2.reference rgit, cera2.citation cgit where c.project_id=2000125 and c.entry_id=ec1.gen_entry_id and ec1.spec_entry_id=ec2.gen_entry_id and ec2.gen_entry_id=edoi.entry_id and ec2.spec_entry_id=eds.entry_id and edoi.entry_id=rdoi.entry_id(+) and rdoi.citation_id=cdoi.citation_id(+) and rdoi.ref_type_id(+)=2000004 and eds.entry_id=rds.entry_id and rcmip.entry_id=edoi.entry_id and rcmip.citation_id=ccmip.citation_id and rcmip.ref_type_id=27 and ccmip.publisher='Earth System Grid Federation' and ripcc.entry_id=eds.entry_id and ripcc.citation_id=cipcc.citation_id and cipcc.publisher='IPCC' and cipcc.additional_info=cds.additional_info and eds.entry_id=ep.entry_id and rds.citation_id=cds.citation_id and cipcc.access_spec like '%ipcc.ch%' and rsw.entry_id=eds.entry_id and rsw.entry_id=eds.entry_id and rsw.citation_id=csw.citation_id and csw.additional_info=cds.additional_info and csw.access_spec like 'doi:10.5281/zenodo.%' and csw.additional_info not like 'Atlas%' and rsw.entry_id=eds.entry_id and rgit.entry_id=eds.entry_id and rgit.citation_id=cgit.citation_id and cgit.additional_info=cds.additional_info and cgit.access_spec like 'https://github.com/IPCC-WG1/%' and cds.citation_id=${citation_id} order by eds.entry_name
#FIG_INFO2:select replace(eds.entry_name,' ','.') as dataset,replace(ep.pid,'hdl:','https://hdl.handle.net/') as DS_PID,replace(edoi.entry_name,' ','.') as doi_collection,replace(cdoi.access_spec,'doi:','') as AR6_CMIP6_DOI,replace(ccmip.access_spec,'doi:','') as CMIP6_DOI,cipcc.access_spec as FIG_URL,cds.additional_info as FIGURE,replace(cds.access_spec,'doi:','') as FIGURE_DOI from cera2.campaign c,cera2.entry edoi,cera2.entry eds,cera2.entry_connect ec1,cera2.entry_connect ec2,cera2.reference rdoi,cera2.citation cdoi,cera2.reference rds,cera2.citation cds,cera2.entry_pid ep,cera2.reference rcmip,cera2.citation ccmip,cera2.reference ripcc,cera2.citation cipcc where c.project_id=2000125 and c.entry_id=ec1.gen_entry_id and ec1.spec_entry_id=ec2.gen_entry_id and ec2.gen_entry_id=edoi.entry_id and ec2.spec_entry_id=eds.entry_id and edoi.entry_id=rdoi.entry_id(+) and rdoi.citation_id=cdoi.citation_id(+) and rdoi.ref_type_id(+)=2000004 and eds.entry_id=rds.entry_id and rcmip.entry_id=edoi.entry_id and rcmip.citation_id=ccmip.citation_id and rcmip.ref_type_id=27 and ccmip.publisher='Earth System Grid Federation' and ripcc.entry_id=eds.entry_id and ripcc.citation_id=cipcc.citation_id and cipcc.publisher='IPCC' and cipcc.additional_info=cds.additional_info and eds.entry_id=ep.entry_id and rds.citation_id=cds.citation_id and cipcc.access_spec like '%ipcc.ch%' and cds.citation_id=${citation_id} order by eds.entry_name
FIG_INFO2:select replace(eds.entry_name,' ','.') as dataset,replace(ep.pid,'hdl:','https://hdl.handle.net/') as DS_PID,replace(edoi.entry_name,' ','.') as doi_collection,replace(cdoi.access_spec,'doi:','') as AR6_CMIP6_DOI,replace(ccmip.access_spec,'doi:','') as CMIP6_DOI,cipcc.access_spec as FIG_URL,cds.additional_info as FIGURE,replace(cds.access_spec,'doi:','') as FIGURE_DOI,cgit.access_spec as CODE_GIT from cera2.campaign c,cera2.entry edoi,cera2.entry eds,cera2.entry_connect ec1,cera2.entry_connect ec2,cera2.reference rdoi,cera2.citation cdoi,cera2.reference rds,cera2.citation cds,cera2.entry_pid ep,cera2.reference rcmip,cera2.citation ccmip,cera2.reference ripcc,cera2.citation cipcc, cera2.reference rgit, cera2.citation cgit where c.project_id=2000125 and c.entry_id=ec1.gen_entry_id and ec1.spec_entry_id=ec2.gen_entry_id and ec2.gen_entry_id=edoi.entry_id and ec2.spec_entry_id=eds.entry_id and edoi.entry_id=rdoi.entry_id(+) and rdoi.citation_id=cdoi.citation_id(+) and rdoi.ref_type_id(+)=2000004 and eds.entry_id=rds.entry_id and rcmip.entry_id=edoi.entry_id and rcmip.citation_id=ccmip.citation_id and rcmip.ref_type_id=27 and ccmip.publisher='Earth System Grid Federation' and ripcc.entry_id=eds.entry_id and ripcc.citation_id=cipcc.citation_id and cipcc.publisher='IPCC' and cipcc.additional_info=cds.additional_info and eds.entry_id=ep.entry_id and rds.citation_id=cds.citation_id and cipcc.access_spec like '%ipcc.ch%' and rgit.entry_id=eds.entry_id and rgit.citation_id=cgit.citation_id and cgit.additional_info=cds.additional_info and cgit.access_spec like 'https://github.com/IPCC-WG1/%' and cds.citation_id=${citation_id} order by eds.entry_name
FIG_INFO3:select replace(eds.entry_name,' ','.') as dataset,replace(ep.pid,'hdl:','https://hdl.handle.net/') as DS_PID,replace(edoi.entry_name,' ','.') as doi_collection,replace(cdoi.access_spec,'doi:','') as AR6_CMIP6_DOI,replace(ccmip.access_spec,'doi:','') as CMIP6_DOI,cipcc.access_spec as FIG_URL,cds.additional_info as FIGURE,replace(cds.access_spec,'doi:','') as FIGURE_DOI from cera2.campaign c,cera2.entry edoi,cera2.entry eds,cera2.entry_connect ec1,cera2.entry_connect ec2,cera2.reference rdoi,cera2.citation cdoi,cera2.reference rds,cera2.citation cds,cera2.entry_pid ep,cera2.reference rcmip,cera2.citation ccmip,cera2.reference ripcc,cera2.citation cipcc where c.project_id=2000125 and c.entry_id=ec1.gen_entry_id and ec1.spec_entry_id=ec2.gen_entry_id and ec2.gen_entry_id=edoi.entry_id and ec2.spec_entry_id=eds.entry_id and edoi.entry_id=rdoi.entry_id(+) and rdoi.citation_id=cdoi.citation_id(+) and rdoi.ref_type_id(+)=2000004 and eds.entry_id=rds.entry_id and rcmip.entry_id=edoi.entry_id and rcmip.citation_id=ccmip.citation_id and rcmip.ref_type_id=27 and ccmip.publisher='Earth System Grid Federation' and ripcc.entry_id=eds.entry_id and ripcc.citation_id=cipcc.citation_id and cipcc.publisher='IPCC' and cipcc.additional_info=cds.additional_info and eds.entry_id=ep.entry_id and rds.citation_id=cds.citation_id and cipcc.access_spec like '%ipcc.ch%' and cds.citation_id=${citation_id} order by eds.entry_name